<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lista miejsc</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #333333;
    }

#header-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
  background-color: #222; /* lub inny kolor tła */
  padding: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3); /* opcjonalny cień */
  color: white
}

#fixed-circle-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;

  width: 50px;
  height: 50px;

  background-color: #222; /* możesz zmienić kolor */
  border-radius: 50%;

  display: flex;
  align-items: center;
  justify-content: center;

  text-decoration: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  transition: background-color 0.3s ease;

  z-index: 10000;
}

/* Możesz dodać ikonę SVG albo tekst w środku */
#fixed-circle-btn::before {
  content: "🏠"; /* albo inny emoji/ikonę */
  font-size: 24px;
  color: white;
}

/* Efekt hover */
#fixed-circle-btn:hover {
  background-color: #0056b3;
}


#sort-menu-container, #search-input {
  margin: 0;
  padding: 0;
  height: auto;
}

#search-input {
  height: 32px; /* np. */
  line-height: 32px;
  box-sizing: border-box;
}

#fixed-circle-btn-jedzonko {
  position: fixed;
  right: 20px;
  bottom: 80px; /* trochę wyżej niż pierwszy */
  width: 60px;
  height: 60px;
  background-color: #28a745; /* zielony */
  border-radius: 50%;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  cursor: pointer;
  background-image: url('https://cdn-icons-png.flaticon.com/512/135/135698.png'); /* jakaś ikonka jedzenia */
  background-size: 50%;
  background-repeat: no-repeat;
  background-position: center;
  transition: background-color 0.3s ease;
  z-index: 10000;
}

#fixed-circle-btn-jedzonko:hover {
  background-color: #1e7e34;
}

    .header-button {
      margin: 5px;
      padding: 8px 12px;
      border: none;
      background-color: #444;
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }

    .header-button:hover {
      background-color: #666;
    }

    #container-wrapper {
      display: flex;
      flex-direction: column;
      padding: 10px;
      gap: 20px;
	    margin-top: 80px;
		color: white
    }

    .item-wrapper {
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

	.item-button {
	  width: 100%;
	  border: none;
	  text-align: left;
	  padding: 0;
	  background-size: cover;
	  background-position: center;
	  background-repeat: no-repeat;
	  color: black;
	  display: flex;
	  flex-direction: column;

	  position: relative; /* dla ::before */
	  z-index: 0;
	}

	.item-button::before {
	  content: "";
	  position: absolute;
	  inset: 0;
	  pointer-events: none;
	  z-index: 1;

	  background: linear-gradient(
		to right,
		rgba(255, 255, 255, 1) 10%,
		rgba(255, 255, 255, 0) 100%
	  );
	}

	.item-button > * {
	  position: relative;
	  z-index: 2;
	}

	.uwagi-background {
	  display: flex;
	  gap: 6px;
	  padding: 4px 1px;
	  background-color: rgba(255,255,255,0.75);
	  flex-wrap: wrap;
	  justify-content: center;
	  align-items: center;
	  margin-top: 10px; /* tutaj dodaj margines na górze */
	}


.uwagi-background .row-content {
  text-align: center;
}


.row-content {
  margin-left: 10px; /* margines dla wszystkich wierszy */
}

/* ale dla wierszy w "Uwagi / Wskazówki" czyli opakowanych w .uwagi-background zostaw bez marginesu */
.uwagi-background .row-content {
  margin-top: 10;
}



.name-content {
  text-align: left; /* zostawia nazwę po lewej */
}


    .row-content {
      padding: 8px 12px;
      background-color: rgba(255,255,255,0.85);
      font-size: 14px;
	    margin-bottom: 10;
    }

    .even .row-content:nth-child(even) {
      background-color: rgba(255,255,255,0);
    }

    .odd .row-content:nth-child(odd) {
      background-color: rgba(245,245,245,0);
    }

	.link-buttons-row {
	  display: flex;
	  gap: 6px;
	  padding: 8px 12px;
	  background-color: rgba(255,255,255,1);
	  flex-wrap: wrap;
	  justify-content: center; /* <-- dodaj */
	  align-items: center;     /* <-- dodaj */
	    margin-top: 10px !important;
	}




.name-content {
  display: flex;
  justify-content: flex-start;
  width: 100%;
  font-weight: bold;
  font-size: 1.5em;
  margin-top: 10px !important;
  margin-left: 3px;
  margin-bottom: 1px;
  position: relative;
}





    .link-button {
      padding: 6px 10px;
      font-size: 12px;
      background-color: #222;
      color: white;
      text-decoration: none;
      border-radius: 6px;
    }

    .link-button:hover {
      background-color: #111;
    }

	#container-wrapper > .item-wrapper:nth-child(odd) {
	  background-color: black;
	}

	#container-wrapper > .item-wrapper:nth-child(even) {
	  background-color: #f8f8f8;
	}

	.row-content {
	  background: transparent; /* lub usuń tło, żeby nie zakrywało */
	  padding: 0px 10px;
	  margin-top: 4px;
	  margin-bottom: 2px;
	}


    @media (max-width: 600px) {
      .row-content {
        font-size: 13px;
      }
    }
	
#search-input {
  width: 120%;
  max-width: 100px;
  padding: 10px 15px;
  margin: 15px auto;
  display: block;
  border: 1px solid #ccc;
  border-radius: 12px;
  font-size: 1em;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  transition: border-color 0.3s, box-shadow 0
  
 .sort-dropdown {
  width: 90%;
  max-width: 300px;
  padding: 10px 15px;
  margin: 10px auto;
  display: block;
  font-size: 1em;
  border: 1px solid #ccc;
  border-radius: 10px;
  background-color: white;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.sort-arrow {
  font-size: 1.3em;
  vertical-align: middle;
  user-select: none;
}

.sort-reset-button:hover {
  color: red;
}

#search-input {
  padding: 6px 10px;
  font-size: 1em;
  border-radius: 4px;
  border: 1px solid #ccc;
  width: 200px;
}

/* Styl dropdowna */
.sort-dropdown {
  padding: 6px 10px;
  font-size: 1em;
  border: 1px solid #ccc;
  border-radius: 6px;
  background-color: black;
  color: #333;
  appearance: none;
  background-image: url('data:image/svg+xml;utf8,<svg fill="%23666" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 12px;
  padding-right: 32px;
  transition: border 0.2s ease-in-out;
}

.sort-dropdown:hover {
  border-color: #888;
}

.sort-dropdown:focus {
  outline: none;
  border-color: #007BFF;
}

/* Styl przycisków sortowania */
.sort-arrow,
.sort-reset-button {
  font-size: 1.2em;
  margin-left: 8px;
  color: #555;
  background-color: transparent;
  border: none;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.sort-arrow:hover,
.sort-reset-button:hover {
  color: #000;
  transform: scale(1.1);
}

@media (max-width: 600px) {
  #header-bar {
    flex-direction: column;
    align-items: stretch;
	flex-wrap: wrap;
  }

  #search-input {
    width: 100%;
    margin-top: 8px;
    margin-left: 0;
  }

  .dropdown {
    width: 100%;
  }
}

  @media (max-width: 600px) {
    #header-bar {
      flex-direction: column;
      align-items: stretch;
    }

    #header-bar > div {
      width: 100%;
    }

    #search-input {
      width: 100%;
      margin: 5px 0;
    }

    #search-clear {
      right: 10px;
    }

    .dropdown-wrapper {
      width: 100% !important;
    }
  }



  </style>
</head>
<body>

  <div id="header-bar"></div>

	<div id="container-wrapper">Ładowanie danych...</div>



  <script>
const sheetID = "18wnO5tOGoIk6BV8EQjUc_ojwaecuqExZqNDOJwQSOI4";
let sheetName = "Zwiedzanko"; // teraz zmienna, którą można zmieniać

function loadData() {
  const url = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;
  fetch(url)
    .then(response => response.json())
    .then(json => {
      data = json;
      if (!data.length) {
        document.getElementById('container-wrapper').textContent = "Brak danych do wyświetlenia.";
        return;
      }

      const headers = Object.keys(data[0]);
      createHeaderBar(headers);
      renderItems(data);

      document.getElementById("search-input").addEventListener("input", sortDataAndRender);
    })
    .catch(err => {
      document.getElementById('container-wrapper').textContent = "Błąd podczas pobierania danych: " + err;
      console.error(err);
    });
}

// na starcie wywołaj
loadData();



    let data = [];
    let currentSort = { key: null, ascending: true };

    function getTimeUntilClose(openingHoursStr) {
      const now = new Date();
      const match = openingHoursStr.match(/(\d{1,2}):(\d{2})\s*(–|-)\s*(\d{1,2}):(\d{2})/);

      if (!match) return "";

      const closeHour = parseInt(match[4], 10);
      const closeMinute = parseInt(match[5], 10);

      const closeTime = new Date();
      closeTime.setHours(closeHour, closeMinute, 0, 0);

      if (closeTime < now) {
        return "(💀)";
      }

      const diffMs = closeTime - now;
      const diffH = Math.floor(diffMs / (1000 * 60 * 60));
      const diffM = Math.floor((diffMs / (1000 * 60)) % 60);

      return `(${diffH}:${diffM.toString().padStart(2, "0")})`;
    }

function createHeaderBar(headers) {
  const headerBar = document.getElementById("header-bar");
  headerBar.innerHTML = "";

  headerBar.style.display = "flex";
  headerBar.style.justifyContent = "space-between";
  headerBar.style.alignItems = "center";
  headerBar.style.flexWrap = "wrap";
  headerBar.style.gap = "10px";

  const sortControls = document.createElement("div");
  sortControls.style.display = "flex";
  sortControls.style.alignItems = "center";
  sortControls.style.position = "relative";
  sortControls.style.marginLeft = "15px"; // ← przesunie cały dropdown w prawo @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


  // Stylowe rozwijane menu
  const dropdownWrapper = document.createElement("div");
  dropdownWrapper.style.position = "relative";
  dropdownWrapper.style.minWidth = "90px";
  dropdownWrapper.style.fontSize = "1em";

  const dropdownButton = document.createElement("div");
  dropdownButton.textContent = "Sortuj ▾";
  dropdownButton.style.padding = "6px 12px";
  dropdownButton.style.border = "2px solid #ccc";
  dropdownButton.style.borderRadius = "100px";
  dropdownButton.style.cursor = "pointer";
  dropdownButton.style.background = "dark gray";
  dropdownButton.style.boxShadow = "0 2px 4px rgba(0,0,0,0.1)";
  dropdownButton.style.transition = "background 0.2s";

  const dropdownList = document.createElement("div");
  dropdownList.style.position = "absolute";
  dropdownList.style.top = "100%";
  dropdownList.style.left = "0";
  dropdownList.style.width = "100%";
  dropdownList.style.border = "1px solid #ccc";
  dropdownList.style.borderTop = "none";
  dropdownList.style.background = "#222222";
  dropdownList.style.borderRadius = "0 0 8px 8px";
  dropdownList.style.boxShadow = "0 4px 8px rgba(0,0,0,0.1)";
  dropdownList.style.display = "none";
  dropdownList.style.zIndex = "999";

  headers.forEach(header => {
    if (["Mapa", "Google", "Strona", "Obrazek", "Uwagi / Wskazówki"].includes(header)) return;

    const item = document.createElement("div");
    item.textContent = header;
    item.style.padding = "8px 12px";
    item.style.cursor = "pointer";
    item.style.borderTop = "1px solid #eee";

    item.addEventListener("mouseenter", () => {
      item.style.background = "dark gray";
    });

    item.addEventListener("mouseleave", () => {
      item.style.background = "dark gray";
    });

    item.addEventListener("click", () => {
      currentSort.key = header;
      currentSort.ascending = true;
      sortArrow.innerHTML = `<img src="https://i.imgur.com/hYMbUQU.png" alt="Sort Arrow" style="width: 38px; height: 38px;">`;
      sortArrow.style.visibility = "visible";
      resetBtn.style.visibility = "visible";
      dropdownButton.textContent = `${header} ▾`;
      dropdownList.style.display = "none";
      sortDataAndRender();
    });

    dropdownList.appendChild(item);
  });

  dropdownButton.addEventListener("click", () => {
    dropdownList.style.display = dropdownList.style.display === "none" ? "block" : "none";
  });

  document.addEventListener("click", (e) => {
    if (!dropdownWrapper.contains(e.target)) {
      dropdownList.style.display = "none";
    }
  });

  dropdownWrapper.appendChild(dropdownButton);
  dropdownWrapper.appendChild(dropdownList);

const sortArrow = document.createElement("div");
sortArrow.innerHTML = '<img src="arrow.svg" alt="Sortuj" style="width: 20px; transition: transform 0.2s;">';
sortArrow.title = "Kliknij, aby zmienić kierunek sortowania";
sortArrow.style.marginLeft = "20px";
sortArrow.style.cursor = "pointer";
sortArrow.style.visibility = "hidden";
sortArrow.addEventListener("click", () => {
  if (!currentSort.key) return;
  currentSort.ascending = !currentSort.ascending;
  sortArrow.style.transform = currentSort.ascending ? "rotate(0deg)" : "rotate(180deg)";
  sortDataAndRender();
});

const resetBtn = document.createElement("div");
resetBtn.textContent = "✖";
resetBtn.title = "Reset sortowania";
resetBtn.className = "sort-reset-button";
resetBtn.style.cursor = "pointer";
resetBtn.style.fontSize = "1.4em";
resetBtn.style.marginLeft = "10px";
resetBtn.style.visibility = "hidden";
resetBtn.addEventListener("click", () => {
  currentSort = { key: null, ascending: true };
  dropdownButton.textContent = "Sortuj ▾";
  sortArrow.style.visibility = "hidden";
  resetBtn.style.visibility = "hidden";
  sortDataAndRender();
});

sortControls.appendChild(dropdownWrapper);
sortControls.appendChild(sortArrow);
sortControls.appendChild(resetBtn);

const searchInput = document.createElement("input");
searchInput.id = "search-input";
searchInput.type = "text";
searchInput.placeholder = "Szukaj...";
searchInput.style.marginRight = "10px";

headerBar.appendChild(sortControls);
headerBar.appendChild(searchInput);
}

function sortDataAndRender() {
  const input = document.getElementById("search-input").value.toLowerCase();

  let filtered = data.filter(entry => {
    return Object.values(entry).some(value =>
      value.toLowerCase().includes(input)
    );
  });

  if (currentSort.key) {
    filtered.sort((a, b) => {
      const valA = a[currentSort.key] || "";
      const valB = b[currentSort.key] || "";
      if (valA < valB) return currentSort.ascending ? -1 : 1;
      if (valA > valB) return currentSort.ascending ? 1 : -1;
      return 0;
    });
  }

  renderItems(filtered);
}

function renderItems(items) {
  const container = document.getElementById("container-wrapper");
  container.innerHTML = "";

  items.forEach((item, index) => {
    const wrapper = document.createElement("div");
    wrapper.className = "item-wrapper";

    const button = document.createElement("button");
    button.className = "item-button";
    button.style.backgroundImage = item.Obrazek ? `url(${item.Obrazek})` : "";

    const name = document.createElement("div");
    name.className = "name-content";
    name.textContent = item.Nazwa || "(bez nazwy)";

    button.appendChild(name);

    const rowContainer = document.createElement("div");
    rowContainer.className = index % 2 === 0 ? "even" : "odd";

    Object.entries(item).forEach(([key, value]) => {
      if (["Nazwa", "Obrazek", "Mapa", "Google", "Strona", "Uwagi / Wskazówki"].includes(key)) return;
      const row = document.createElement("div");
      row.className = "row-content";
      row.textContent = `${key}: ${value}`;
      rowContainer.appendChild(row);
    });

    button.appendChild(rowContainer);

    if (item["Uwagi / Wskazówki"]) {
      const uwagiDiv = document.createElement("div");
      uwagiDiv.className = "uwagi-background";

      item["Uwagi / Wskazówki"].split(";").forEach(uw => {
        const row = document.createElement("div");
        row.className = "row-content";
        row.textContent = uw.trim();
        uwagiDiv.appendChild(row);
      });

      button.appendChild(uwagiDiv);
    }

    const links = document.createElement("div");
    links.className = "link-buttons-row";

    if (item.Mapa) {
      const mapaBtn = document.createElement("a");
      mapaBtn.href = item.Mapa;
      mapaBtn.textContent = "Mapa";
      mapaBtn.target = "_blank";
      mapaBtn.className = "link-button";
      links.appendChild(mapaBtn);
    }

    if (item.Google) {
      const googleBtn = document.createElement("a");
      googleBtn.href = item.Google;
      googleBtn.textContent = "Google";
      googleBtn.target = "_blank";
      googleBtn.className = "link-button";
      links.appendChild(googleBtn);
    }

    if (item.Strona) {
      const stronaBtn = document.createElement("a");
      stronaBtn.href = item.Strona;
      stronaBtn.textContent = "Strona";
      stronaBtn.target = "_blank";
      stronaBtn.className = "link-button";
      links.appendChild(stronaBtn);
    }

    button.appendChild(links);
    wrapper.appendChild(button);
    container.appendChild(wrapper);
  });
}
</script>

<a href="#" id="fixed-circle-btn"></a>
<a href="#" id="fixed-circle-btn-jedzonko" title="Jedzonko!"></a>

</body>
</html>


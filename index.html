<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lista miejsc</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #333333;
    }

#header-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
  background-color: #222; /* lub inny kolor t≈Ça */
  padding: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3); /* opcjonalny cie≈Ñ */
  color: white
}

#fixed-circle-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;

  width: 50px;
  height: 50px;

  background-color: #222; /* mo≈ºesz zmieniƒá kolor */
  border-radius: 50%;

  display: flex;
  align-items: center;
  justify-content: center;

  text-decoration: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  transition: background-color 0.3s ease;

  z-index: 10000;
}

/* Mo≈ºesz dodaƒá ikonƒô SVG albo tekst w ≈õrodku */
#fixed-circle-btn::before {
  content: "üè†"; /* albo inny emoji/ikonƒô */
  font-size: 24px;
  color: white;
}

/* Efekt hover */
#fixed-circle-btn:hover {
  background-color: #0056b3;
}


#sort-menu-container, #search-input {
  margin: 0;
  padding: 0;
  height: auto;
}

#search-input {
  height: 32px; /* np. */
  line-height: 32px;
  box-sizing: border-box;
}

#fixed-circle-btn-jedzonko {
  position: fixed;
  right: 20px;
  bottom: 80px; /* trochƒô wy≈ºej ni≈º pierwszy */
  width: 60px;
  height: 60px;
  background-color: #28a745; /* zielony */
  border-radius: 50%;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  cursor: pointer;
  background-image: url('https://cdn-icons-png.flaticon.com/512/135/135698.png'); /* jaka≈õ ikonka jedzenia */
  background-size: 50%;
  background-repeat: no-repeat;
  background-position: center;
  transition: background-color 0.3s ease;
  z-index: 10000;
}

#fixed-circle-btn-jedzonko:hover {
  background-color: #1e7e34;
}

    .header-button {
      margin: 5px;
      padding: 8px 12px;
      border: none;
      background-color: #444;
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }

    .header-button:hover {
      background-color: #666;
    }

    #container-wrapper {
      display: flex;
      flex-direction: column;
      padding: 10px;
      gap: 20px;
	    margin-top: 80px;
		color: white
    }

    .item-wrapper {
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

	.item-button {
	  width: 100%;
	  border: none;
	  text-align: left;
	  padding: 0;
	  background-size: cover;
	  background-position: center;
	  background-repeat: no-repeat;
	  color: black;
	  display: flex;
	  flex-direction: column;

	  position: relative; /* dla ::before */
	  z-index: 0;
	}

	.item-button::before {
	  content: "";
	  position: absolute;
	  inset: 0;
	  pointer-events: none;
	  z-index: 1;

	  background: linear-gradient(
		to right,
		rgba(255, 255, 255, 1) 10%,
		rgba(255, 255, 255, 0) 100%
	  );
	}

	.item-button > * {
	  position: relative;
	  z-index: 2;
	}

	.uwagi-background {
	  display: flex;
	  gap: 6px;
	  padding: 4px 1px;
	  background-color: rgba(255,255,255,0.75);
	  flex-wrap: wrap;
	  justify-content: center;
	  align-items: center;
	  margin-top: 10px; /* tutaj dodaj margines na g√≥rze */
	}


.uwagi-background .row-content {
  text-align: center;
}


.row-content {
  margin-left: 10px; /* margines dla wszystkich wierszy */
}

/* ale dla wierszy w "Uwagi / Wskaz√≥wki" czyli opakowanych w .uwagi-background zostaw bez marginesu */
.uwagi-background .row-content {
  margin-top: 10;
}



.name-content {
  text-align: left; /* zostawia nazwƒô po lewej */
}


    .row-content {
      padding: 8px 12px;
      background-color: rgba(255,255,255,0.85);
      font-size: 14px;
	    margin-bottom: 10;
    }

    .even .row-content:nth-child(even) {
      background-color: rgba(255,255,255,0);
    }

    .odd .row-content:nth-child(odd) {
      background-color: rgba(245,245,245,0);
    }

	.link-buttons-row {
	  display: flex;
	  gap: 6px;
	  padding: 8px 12px;
	  background-color: rgba(255,255,255,1);
	  flex-wrap: wrap;
	  justify-content: center; /* <-- dodaj */
	  align-items: center;     /* <-- dodaj */
	    margin-top: 10px !important;
	}




.name-content {
  display: flex;
  justify-content: flex-start;
  width: 100%;
  font-weight: bold;
  font-size: 1.5em;
  margin-top: 10px !important;
  margin-left: 3px;
  margin-bottom: 1px;
  position: relative;
}





    .link-button {
      padding: 6px 10px;
      font-size: 12px;
      background-color: #222;
      color: white;
      text-decoration: none;
      border-radius: 6px;
    }

    .link-button:hover {
      background-color: #111;
    }

	#container-wrapper > .item-wrapper:nth-child(odd) {
	  background-color: black;
	}

	#container-wrapper > .item-wrapper:nth-child(even) {
	  background-color: #f8f8f8;
	}

	.row-content {
	  background: transparent; /* lub usu≈Ñ t≈Ço, ≈ºeby nie zakrywa≈Ço */
	  padding: 0px 10px;
	  margin-top: 4px;
	  margin-bottom: 2px;
	}


    @media (max-width: 600px) {
      .row-content {
        font-size: 13px;
      }
    }
	
#search-input {
  width: 90%;
  max-width: 500px;
  padding: 10px 15px;
  margin: 15px auto;
  display: block;
  border: 1px solid #ccc;
  border-radius: 12px;
  font-size: 1em;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  transition: border-color 0.3s, box-shadow 0
  
 .sort-dropdown {
  width: 90%;
  max-width: 300px;
  padding: 10px 15px;
  margin: 10px auto;
  display: block;
  font-size: 1em;
  border: 1px solid #ccc;
  border-radius: 10px;
  background-color: white;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.sort-arrow {
  font-size: 1.3em;
  vertical-align: middle;
  user-select: none;
}

.sort-reset-button:hover {
  color: red;
}

#search-input {
  padding: 6px 10px;
  font-size: 1em;
  border-radius: 4px;
  border: 1px solid #ccc;
  width: 200px;
}

/* Styl dropdowna */
.sort-dropdown {
  padding: 6px 10px;
  font-size: 1em;
  border: 1px solid #ccc;
  border-radius: 6px;
  background-color: black;
  color: #333;
  appearance: none;
  background-image: url('data:image/svg+xml;utf8,<svg fill="%23666" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 12px;
  padding-right: 32px;
  transition: border 0.2s ease-in-out;
}

.sort-dropdown:hover {
  border-color: #888;
}

.sort-dropdown:focus {
  outline: none;
  border-color: #007BFF;
}

/* Styl przycisk√≥w sortowania */
.sort-arrow,
.sort-reset-button {
  font-size: 1.2em;
  margin-left: 8px;
  color: #555;
  background-color: transparent;
  border: none;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.sort-arrow:hover,
.sort-reset-button:hover {
  color: #000;
  transform: scale(1.1);
}

  </style>
</head>
<body>

  <div id="header-bar"></div>

	<div id="container-wrapper">≈Åadowanie danych...</div>



  <script>
const sheetID = "18wnO5tOGoIk6BV8EQjUc_ojwaecuqExZqNDOJwQSOI4";
let sheetName = "Zwiedzanko"; // teraz zmienna, kt√≥rƒÖ mo≈ºna zmieniaƒá

function loadData() {
  const url = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;
  fetch(url)
    .then(response => response.json())
    .then(json => {
      data = json;
      if (!data.length) {
        document.getElementById('container-wrapper').textContent = "Brak danych do wy≈õwietlenia.";
        return;
      }

      const headers = Object.keys(data[0]);
      createHeaderBar(headers);
      renderItems(data);

      document.getElementById("search-input").addEventListener("input", sortDataAndRender);
    })
    .catch(err => {
      document.getElementById('container-wrapper').textContent = "B≈ÇƒÖd podczas pobierania danych: " + err;
      console.error(err);
    });
}

// na starcie wywo≈Çaj
loadData();



    let data = [];
    let currentSort = { key: null, ascending: true };

    function getTimeUntilClose(openingHoursStr) {
      const now = new Date();
      const match = openingHoursStr.match(/(\d{1,2}):(\d{2})\s*(‚Äì|-)\s*(\d{1,2}):(\d{2})/);

      if (!match) return "";

      const closeHour = parseInt(match[4], 10);
      const closeMinute = parseInt(match[5], 10);

      const closeTime = new Date();
      closeTime.setHours(closeHour, closeMinute, 0, 0);

      if (closeTime < now) {
        return "(üíÄ)";
      }

      const diffMs = closeTime - now;
      const diffH = Math.floor(diffMs / (1000 * 60 * 60));
      const diffM = Math.floor((diffMs / (1000 * 60)) % 60);

      return `(${diffH}:${diffM.toString().padStart(2, "0")})`;
    }

function createHeaderBar(headers) {
  const headerBar = document.getElementById("header-bar");
  headerBar.innerHTML = "";

  headerBar.style.display = "flex";
  headerBar.style.justifyContent = "space-between";
  headerBar.style.alignItems = "center";
  headerBar.style.flexWrap = "wrap";
  headerBar.style.gap = "10px";

  const sortControls = document.createElement("div");
  sortControls.style.display = "flex";
  sortControls.style.alignItems = "center";
  sortControls.style.position = "relative";
  sortControls.style.marginLeft = "15px"; // ‚Üê przesunie ca≈Çy dropdown w prawo @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


  // Stylowe rozwijane menu
  const dropdownWrapper = document.createElement("div");
  dropdownWrapper.style.position = "relative";
  dropdownWrapper.style.minWidth = "90px";
  dropdownWrapper.style.fontSize = "1em";

  const dropdownButton = document.createElement("div");
  dropdownButton.textContent = "Sortuj wed≈Çug ‚ñæ";
  dropdownButton.style.padding = "6px 12px";
  dropdownButton.style.border = "2px solid #ccc";
  dropdownButton.style.borderRadius = "100px";
  dropdownButton.style.cursor = "pointer";
  dropdownButton.style.background = "dark gray";
  dropdownButton.style.boxShadow = "0 2px 4px rgba(0,0,0,0.1)";
  dropdownButton.style.transition = "background 0.2s";

  const dropdownList = document.createElement("div");
  dropdownList.style.position = "absolute";
  dropdownList.style.top = "100%";
  dropdownList.style.left = "0";
  dropdownList.style.width = "100%";
  dropdownList.style.border = "1px solid #ccc";
  dropdownList.style.borderTop = "none";
  dropdownList.style.background = "#222222";
  dropdownList.style.borderRadius = "0 0 8px 8px";
  dropdownList.style.boxShadow = "0 4px 8px rgba(0,0,0,0.1)";
  dropdownList.style.display = "none";
  dropdownList.style.zIndex = "999";

  headers.forEach(header => {
    if (["Mapa", "Google", "Strona", "Obrazek", "Uwagi / Wskaz√≥wki"].includes(header)) return;

    const item = document.createElement("div");
    item.textContent = header;
    item.style.padding = "8px 12px";
    item.style.cursor = "pointer";
    item.style.borderTop = "1px solid #eee";

    item.addEventListener("mouseenter", () => {
      item.style.background = "dark gray";
    });

    item.addEventListener("mouseleave", () => {
      item.style.background = "dark gray";
    });

    item.addEventListener("click", () => {
      currentSort.key = header;
      currentSort.ascending = true;
      sortArrow.innerHTML = `<img src="https://i.imgur.com/hYMbUQU.png" alt="Sort Arrow" style="width: 38px; height: 38px;">`;
      sortArrow.style.visibility = "visible";
      resetBtn.style.visibility = "visible";
      dropdownButton.textContent = `${header} ‚ñæ`;
      dropdownList.style.display = "none";
      sortDataAndRender();
    });

    dropdownList.appendChild(item);
  });

  dropdownButton.addEventListener("click", () => {
    dropdownList.style.display = dropdownList.style.display === "none" ? "block" : "none";
  });

  document.addEventListener("click", (e) => {
    if (!dropdownWrapper.contains(e.target)) {
      dropdownList.style.display = "none";
    }
  });

  dropdownWrapper.appendChild(dropdownButton);
  dropdownWrapper.appendChild(dropdownList);

const sortArrow = document.createElement("div");
sortArrow.innerHTML = '<img src="arrow.svg" alt="Sortuj" style="width: 20px; transition: transform 0.2s;">';
sortArrow.title = "Kliknij, aby zmieniƒá kierunek sortowania";
sortArrow.style.marginLeft = "20px";
sortArrow.style.cursor = "pointer";
sortArrow.style.userSelect = "none";
sortArrow.style.visibility = "hidden";
sortArrow.style.display = "flex";
sortArrow.style.alignItems = "center";
sortArrow.style.justifyContent = "center";


  sortArrow.addEventListener("click", () => {
    if (!currentSort.key) return;
    currentSort.ascending = !currentSort.ascending;
    const img = sortArrow.querySelector("img");
	img.style.transform = currentSort.ascending ? "rotate(0deg)" : "rotate(180deg)";
    sortDataAndRender();
  });

const resetBtn = document.createElement("button");
resetBtn.innerHTML = `<img src="https://i.imgur.com/FRA2W1u.png" alt="Reset" style="width: 38px; height: 38px;">`;
resetBtn.title = "Resetuj sortowanie";
resetBtn.style.marginLeft = "15px";
resetBtn.style.cursor = "pointer";
resetBtn.style.fontSize = "1.2em";
resetBtn.style.userSelect = "none";
resetBtn.style.background = "transparent";
resetBtn.style.border = "none";
resetBtn.style.color = "#666";
resetBtn.style.visibility = "hidden";
resetBtn.style.display = "flex";
resetBtn.style.alignItems = "center";
resetBtn.style.justifyContent = "center";


  resetBtn.addEventListener("click", () => {
    currentSort.key = "";
    currentSort.ascending = true;
    sortArrow.style.visibility = "hidden";
    resetBtn.style.visibility = "hidden";
    dropdownButton.textContent = "Sortuj wed≈Çug ‚ñæ";
    sortDataAndRender();
  });

  sortControls.appendChild(dropdownWrapper);
  sortControls.appendChild(sortArrow);
  sortControls.appendChild(resetBtn);

  // Wyszukiwanie
  const searchContainer = document.createElement("div");
  searchContainer.style.position = "relative";
  searchContainer.style.display = "inline-block";
  searchContainer.style.marginRight = "25px"; // np. 20px odstƒôpu od prawejprawejprawejprawejprawejprawejprawejprawejprawejprawejprawejprawejprawej


  const searchInput = document.createElement("input");
  searchInput.type = "text";
  searchInput.id = "search-input";
  searchInput.placeholder = "Szukaj po nazwie...";
  searchInput.style.padding = "6px 28px 6px 10px";
  searchInput.style.fontSize = "1em";
  searchInput.style.border = "1px solid #ccc";
  searchInput.style.borderRadius = "100px";

  const clearBtn = document.createElement("button");
  clearBtn.id = "search-clear";
  clearBtn.textContent = "‚úï";
  clearBtn.title = "Wyczy≈õƒá wyszukiwanie";
  clearBtn.style.position = "absolute";
  clearBtn.style.right = "15px";
  clearBtn.style.top = "50%";
  clearBtn.style.transform = "translateY(-50%)";
  clearBtn.style.border = "none";
  clearBtn.style.background = "transparent";
  clearBtn.style.fontSize = "16px";
  clearBtn.style.cursor = "pointer";
  clearBtn.style.color = "#666";
  clearBtn.style.display = "none";

  searchInput.addEventListener("input", () => {
    clearBtn.style.display = searchInput.value ? "inline" : "none";
    sortDataAndRender();
  });

  clearBtn.addEventListener("click", () => {
    searchInput.value = "";
    clearBtn.style.display = "none";
    sortDataAndRender();
  });

  searchContainer.appendChild(searchInput);
  searchContainer.appendChild(clearBtn);

  headerBar.appendChild(sortControls);
  headerBar.appendChild(searchContainer);
}




function sortDataAndRender() {
  let filteredData = [...data];

  const searchValue = document.getElementById("search-input")?.value.toLowerCase().trim();
  if (searchValue) {
    filteredData = filteredData.filter(item => 
      (item["Nazwa"] || "").toLowerCase().includes(searchValue)
    );
  }

  if (!currentSort.key) {
    renderItems(filteredData);
    return;
  }

  // Sortowanie na filteredData
  filteredData.sort((a, b) => {
    let valA = (a[currentSort.key] || "").toString().trim();
    let valB = (b[currentSort.key] || "").toString().trim();

    const numA = parseFloat(valA.replace(',', '.'));
    const numB = parseFloat(valB.replace(',', '.'));

    if (!isNaN(numA) && !isNaN(numB)) {
      return currentSort.ascending ? numA - numB : numB - numA;
    }

    const dateA = new Date(valA);
    const dateB = new Date(valB);

    if (!isNaN(dateA) && !isNaN(dateB)) {
      return currentSort.ascending ? dateA - dateB : dateB - dateA;
    }

    valA = valA.toLowerCase();
    valB = valB.toLowerCase();

    if (valA < valB) return currentSort.ascending ? -1 : 1;
    if (valA > valB) return currentSort.ascending ? 1 : -1;
    return 0;
  });

  renderItems(filteredData);
}




	function renderItems(items) {
	  const container = document.getElementById("container-wrapper");
	  container.innerHTML = "";

	  items.forEach((item, index) => {
		const wrapper = document.createElement("div");
		wrapper.className = `item-wrapper ${index % 2 === 0 ? "even" : "odd"}`;

		const button = document.createElement("button");
		button.className = "item-button";

		if (item["Obrazek"]) {
		  button.style.backgroundImage = `url(${item["Obrazek"]})`;
		}

		const linksRow = document.createElement("div");
		linksRow.className = "link-buttons-row";

		Object.keys(item).forEach((key) => {
		  let value = item[key] || "";

		  if (value.trim() === "") return;

		  if (["Mapa", "Google", "Strona"].includes(key) && value.includes("http")) {
			const link = document.createElement("a");
			link.href = value;
			link.textContent = key;
			link.target = "_blank";
			link.className = "link-button";
			linksRow.appendChild(link);
		  } else if (!["Mapa", "Google", "Strona", "Obrazek"].includes(key)) {
			// Tworzymy wiersz
			const row = document.createElement("div");
			row.className = `row-content`;

			if (key === "Godziny otwarcia") {
			  value += " " + getTimeUntilClose(value);
			}

			if (key === "Uwagi / Wskaz√≥wki") {
			  // Tworzymy tekst
			  row.textContent = value;

			  // Tworzymy dodatkowy div z t≈Çem
			  const bg = document.createElement("div");
			  bg.className = "uwagi-background";

			  bg.appendChild(row);
			  button.appendChild(bg);
			} else if (key === "Nazwa") {
			  row.textContent = value;
			  row.classList.add("name-content");
			  button.appendChild(row);
			} else {
			row.innerHTML = `<strong>${key}:</strong> ${value}`;
			button.appendChild(row);
			}
		  }
		});

		if (linksRow.children.length > 0) {
		  button.appendChild(linksRow);
		}

		wrapper.appendChild(button);
		container.appendChild(wrapper);
	  });
	}

// Przycisk prze≈ÇƒÖczajƒÖcy arkusz i ikonƒô
const btnToggleSheet = document.createElement("button");
btnToggleSheet.title = "Prze≈ÇƒÖcz arkusz";
btnToggleSheet.style.position = "fixed";
btnToggleSheet.style.bottom = "80px";
btnToggleSheet.style.right = "20px";
btnToggleSheet.style.borderRadius = "50%";
btnToggleSheet.style.width = "50px";
btnToggleSheet.style.height = "50px";
btnToggleSheet.style.fontSize = "24px";
btnToggleSheet.style.cursor = "pointer";
btnToggleSheet.style.backgroundColor = "#222";
btnToggleSheet.style.border = "none";
btnToggleSheet.style.color = "white";
btnToggleSheet.style.display = "flex";
btnToggleSheet.style.alignItems = "center";
btnToggleSheet.style.justifyContent = "center";
btnToggleSheet.style.boxShadow = "0 2px 5px rgba(0,0,0,0.3)";

let showingArkusz1 = true;

btnToggleSheet.textContent = "üçΩÔ∏è";  // ikona dokumentu dla Zwiedzanko

btnToggleSheet.addEventListener("click", () => {
  if (showingArkusz1) {
    sheetName = "Jedzonko";
    btnToggleSheet.textContent = "üìÑ"; // ikona talerza dla Jedzonko
  } else {
    sheetName = "Zwiedzanko";
    btnToggleSheet.textContent = "üçΩÔ∏è";  // ikona dokumentu
  }
  showingArkusz1 = !showingArkusz1;
  loadData();
});

document.body.appendChild(btnToggleSheet);

// Na start ≈Çadujemy dane
loadData();



	fetch(url)
	  .then(response => response.json())
	  .then(json => {
		data = json;
		if (!data.length) {
		  document.getElementById('container-wrapper').textContent = "Brak danych do wy≈õwietlenia.";
		  return;
		}

		const headers = Object.keys(data[0]);
		createHeaderBar(headers);
		renderItems(data);

		// ‚úÖ TU DODAJ TO:
		document.getElementById("search-input").addEventListener("input", sortDataAndRender);
	  })
	  .catch(err => {
		document.getElementById('container-wrapper').textContent = "B≈ÇƒÖd podczas pobierania danych: " + err;
		console.error(err);
	  });

  </script>
  <a href="https://twoja-strona.pl" target="_blank" id="fixed-circle-btn" title="Odwied≈∫ stronƒô"></a>

</body>
</html>
